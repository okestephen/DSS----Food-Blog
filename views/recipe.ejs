<%- include("partials/header.ejs") %>

<main class="container">
  <% if (!recipe) { %>
    <h2>Recipe not found.</h2>
  <% } else { %>
    <article class="recipe-detail">
      <h1><%= recipe.title %></h1>

      <img
        src="/uploads/<%= recipe.main_image %>"
        class="main-img"
        alt="<%= recipe.title %>"
      >

      <p><%= recipe.description %></p>

      <section>
        <h2>Ingredients</h2>
        <ul>
          <% recipe.ingredients.forEach(item => { %>
            <li><%= item %></li>
          <% }) %>
        </ul>
      </section>

      <section>
        <h2>Steps</h2>
        <ol>
          <% recipe.steps.forEach(step => { %>
            <li><%= step %></li>
          <% }) %>
        </ol>
      </section>

      <p><strong>Prep:</strong> <%= recipe.prep_time %> mins</p>
      <p><strong>Cook:</strong> <%= recipe.cook_time %> mins</p>
      <p><strong>Serves:</strong> <%= recipe.servings %></p>

      <% if (recipe.tags && recipe.tags.length) { %>
        <p>Tags:
          <% recipe.tags.forEach(tag => { %>
            <span class="badge"><%= tag %></span>
          <% }) %>
        </p>
      <% } %>

      <% if (recipe.video_url) { %>
        <div class="video">
          <iframe
            src="<%= recipe.video_url.replace('watch?v=', 'embed/') %>"
            allowfullscreen
          ></iframe>
        </div>
      <% } %>

      <% if (recipe.extra_images && recipe.extra_images.length) { %>
        <div class="extra-images">
          <% recipe.extra_images.forEach(img => { %>
            <img
              src="/uploads/<%= img %>"
              width="120"
              alt="Extra image"
            >
          <% }) %>
        </div>
      <% } %>

      <!-- (Later: Edit/Delete buttons for the owner) -->
    </article>
  <% } %>
</main>

<%- include("partials/footer.ejs") %>
